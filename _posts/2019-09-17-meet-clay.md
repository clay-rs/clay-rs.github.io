---
layout: post
title:  "Clay - ray tracer in Rust and OpenCL"
date:   2019-09-17 08:37:00 +0700
---

## Preface

Hello! My name is Alexey and I'm interested in many things including physics, mathematics and computer science.

I like computer graphics and especially ray tracing because being based only on a few physical rules it is able to produce beautiful images.

Sometimes a new interesting (as it seems to me) idea about ray tracing comes to my mind. To verify such idea it's sometimes necessary to implement it as a computer program which requires a lot of boilerplate code. It would be nice to have some flexible framework for experimenting with ray tracing.

Some existing ray tracing engines are proprietary, some are too specialized and aren't flexible enough. I've found the amazing [Mitsuba ray tracer](https://www.mitsuba-renderer.org/) which is open-source, research-oriented and very customizable. But it seems to be relatively heavy and complex, and, what is most important, it is said to be quite slow. But it would be nice to have an engine that produce perceptible image as fast as possible - in real-time in the ideal case.

I've already implemented some kind of ray tracing engine while trying to render parametric surfaces like biquadratic Bezier patches ([source code](https://github.com/agerasev/cltracer), [demo](https://youtu.be/Fz5wcgmms_Q)). It is written in C++ and OpenCL and is quite fast - it renders a scene of sufficient quality in real-time because it runs on GPU. Here is the video rendered by it:

{% include youtube_player.html id="Fz5wcgmms_Q" %}

But it is very specialized for its current task and it would be quite painful to adapt it for a new one.

So I decided to implement a new ray tracing engine with GPGPU support using fresh new tools and taking previous mistakes into account. 

## Contribution

Contributions are extremely welcome. The project is designed to be very powerful, but for now it contains only basic functionality, so there is a lot of things to implement.

Here is the possible directions of contribution:

+ *New shapes, materials, etc.* - there are only basic primitives like ellipse and parallelepiped added for testing purposes, but it is possible to add various types of objects like composite objects (made of polygons, for example), scalar function for ray marching, some objects for volumetric rendering and many others.
+ *New techniques of raytracing* - for now there is only basic backward ray propagation technique implemented with some improvement in importance sampling. But it would be great to implement some advanced techniques like bidirectional ray tracing, Metropolis light transport, photon maps and other ones.
+ *Tests and debugging* - the project lacks of testing a lot. Tests should be added to check current functionality and avoid regression in the future, as well as testing new features.
+ *Optimization and benchmarking* - there are a lot of unoptimized performance-critical code, and also a reliable method of performance measurement is requred.
+ *Documentation* - it would be nice to add more user-friendly documentation, examples and tutorials.
+ *Project architecture* - some ideas of extending or improving core structure to make the project more suitable for some new functionality or fix some flaws may be provided and considered.
